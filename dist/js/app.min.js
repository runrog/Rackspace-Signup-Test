"use strict";!function(t){t.fn.rsSignUp=function(s){var e=t.extend({},{form:!1,validate:!1},s),r=t(".rsSignup-cost, #summary-total"),a=t(".rsSignup-boxes"),i=t(".rsForm-global-errors"),n=t(".rsForm-loader"),p=t(".rsForm-submitStep"),u=t(".rsForm-summary-products"),o=0,l=0,d={email:0,emailPlus:0,exchange:0},c={addBoxes:function(s){l=0,o=0,d.email=0,d.emailPlus=0,d.exchange=0,s.find('[name="rs-add-quantity"]').each(function(){var s=t(this),e=s.attr("data-product"),r=parseInt(s.attr("data-cost"),10),a=parseInt(s.val(),10);a>=0&&(o+=r*a,l+=a,d[e]=a)}),l>=0&&(a.html(l),r.html(c.convertToDollars(o)))},convertToDollars:function(t){return(t/100).toLocaleString("en-US",{style:"currency",currency:"USD"})}},m={checkRequired:function(t){return{passed:""!==t.trim()}},checkMinVal:function(t,s){return{passed:parseInt(t,10)>=parseInt(s,10)}},checkMaxVal:function(t,s){return{passed:parseInt(t,10)<=parseInt(s,10)}},initialPassword:"",confirmPassword:function(t,s){return{passed:t===s}},checkType:function(t,s){return{passed:t.match({email:/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/gi,creditcard:/^\d{4}\s\d{4}\s\d{4}\s\d{4}$/,cvv:/^\d{3}$/,date:/^\d{2}\s\/\s\d{2}$/}[s])}},passed:function(s){var e=[];return s.find("input").each(function(){var s=t(this),r=[],a=s.next(".rsMultiStep-validation-message");a.length>0?a.html(""):(a=t('<div class="rsMultiStep-validation-message"></div>')).insertAfter(s);var i=s.attr("data-validate"),n=s.val();if(i){var p=JSON.parse(i);if(p.required&&!m.checkRequired(n).passed){var u="This value is required";e.push(u),r.push(u)}if(!isNaN(p.min)&&!m.checkMinVal(n,p.min).passed){var o="This value must be at least "+p.min;e.push(o),r.push(o)}if(!isNaN(p.max)&&!m.checkMaxVal(n,p.max).passed){var l="This value must not exceed "+p.max;e.push(l),r.push(l)}if(p.type&&!m.checkType(n,p.type).passed){var d="This value must have a valid "+p.type+" format";e.push(d),r.push(d)}if(p.password&&("initial"===p.password&&(m.initialPassword=n),"match"===p.password&&!m.confirmPassword(n,m.initialPassword).passed)){var c="Your passwords do not match";e.push(c),r.push(c)}a.html(r.join(". "))}}),e.length<1}},h=t(this).find(".rsMultiStep-step");return h.eq(1).find(".rsMultiStep-btnRow").append('<button class="rsMultiStep-submitBtn">Purchase</button>'),h.each(function(){var s=t(this),r=s.index()+1,a=s.attr("data-step-label");s.parent().prev(".rsMultiStep-progress").append('<span class="rsMultiStep-progressStep rsMultiStep-progressStep'+r+'">\n                              <div class="rsMultiStep-progressStep-num"></div>\n                             </span>'),s.parent().prev(".rsMultiStep-progress").find(".rsMultiStep-progressStep"+r).append(a),s.parent().prev(".rsMultiStep-progress").find(".rsMultiStep-progressStep"+r).find(".rsMultiStep-progressStep-num").html(r);var o=t('<button class="rsMultiStep-nextBtn">Next</button>'),h=t('<button class="rsMultiStep-backBtn">Back</button>'),S=s.find(".rsMultiStep-btnRow"),f=s.parent().prev(".rsMultiStep-progress");s.is(":first-child")&&(s.addClass("rsMultiStep-stepActive"),f.find(".rsMultiStep-progressStep"+r+" .rsMultiStep-progressStep-num").addClass("rsMultiStep-progressStep-numActive"),S.prepend(o)),s.is(":not(:first-child)")&&s.is(":not(:last-child)")&&S.prepend(h),s.find('[name="rs-add-quantity"]').each(function(){t(this).on("keyup",function(){return c.addBoxes(s)})});var v=function(){s.css("height",s.outerHeight()),s.css("width",s.outerWidth()),s.addClass("position-absolute"),s.animate({marginLeft:"-200px",opacity:0},300),s.next().addClass("rsMultiStep-stepActive"),setTimeout(function(){s.removeClass("rsMultiStep-stepActive")},300),f.find(".rsMultiStep-progressStep"+r).next().find(".rsMultiStep-progressStep-num").addClass("rsMultiStep-progressStep-numActive")},M=s.find(".rsMultiStep-backBtn"),g=s.find(".rsMultiStep-nextBtn, .rsMultiStep-submitBtn");g.click(function(r){if(!s.is(":animated")){if(r.preventDefault(),s.removeClass("rsMultiStep-step-error"),e.form&&e.validate&&!m.passed(s))return void s.addClass("rsMultiStep-step-error");if(i.hide(),l<=0)return i.show().html("You must have at least 1 mail box to proceed."),void s.addClass("rsMultiStep-step-error");if(t(r.currentTarget).hasClass("rsMultiStep-submitBtn")){n.show(),p.hide(),M.hide(),g.hide(),t.ajax({type:"POST",url:"https://cors-anywhere.herokuapp.com/https://postman-echo.com/post",headers:{"Content-Type":"application/json"},data:JSON.stringify({form:"data-here"}),success:function(){u.html('\n                  <span class="rsForm-summary-quantity">Rackspace Email x '+d.email+' Mailboxe(s)</span>\n                  <span class="rsForm-summary-quantity">Rackspace Email Plus x '+d.emailPlus+' Mailboxe(s)</span>\n                  <span class="rsForm-summary-quantity">Microsoft Exchange x '+d.exchange+" Mailboxe(s)</span>\n                "),v()},error:function(){s.addClass("rsMultiStep-step-error"),i.show().html("There was an error. Please try again!")},complete:function(){n.hide(),p.show(),M.show(),g.show()}})}else v()}}),M.click(function(t){s.prev().is(":animated")||(t.preventDefault(),s.removeClass("rsMultiStep-stepActive"),s.prev().removeClass("position-absolute"),s.prev().addClass("rsMultiStep-stepActive"),s.prev().animate({marginLeft:"0px",opacity:1},300),setTimeout(function(){s.prev().css("height",""),s.prev().css("width","")},300),f.find(".rsMultiStep-progressStep"+r+" .rsMultiStep-progressStep-num").removeClass("rsMultiStep-progressStep-numActive"))})}),t.fn.rsSignUp.test=t.extend({},c,m),this}}(jQuery);