"use strict";!function(t){t.fn.rsSignUp=function(s){var e=t.extend({},{form:!1,validate:!1},s),a=t(".rsSignup-cost, #summary-total"),r=t(".rsSignup-boxes"),i=t(".rsForm-global-errors"),n=t(".rsForm-loader"),p=t(".rsForm-submitStep"),u=t(".rsForm-summary-products"),o=0,l=0,c={email:0,emailPlus:0,exchange:0},d={addBoxes:function(s){l=0,o=0,c.email=0,c.emailPlus=0,c.exchange=0,s.find('[name="rs-add-quantity"]').each(function(){var s=t(this),e=s.attr("data-product"),a=parseInt(s.attr("data-cost"),10),r=parseInt(s.val(),10);r>=0&&(o+=a*r,l+=r,c[e]=r)}),l>=0&&(r.html(l),a.html(d.convertToDollars(o)))},convertToDollars:function(t){return(t/100).toLocaleString("en-US",{style:"currency",currency:"USD"})}},m={checkRequired:function(t){return{passed:""!==t.val().trim()}},checkMinVal:function(t,s){return{passed:parseInt(t.val(),10)>=parseInt(s,10)}},checkMaxVal:function(t,s){return{passed:parseInt(t.val(),10)<=parseInt(s,10)}},initialPassword:"",confirmPassword:function(t){return{passed:t.val()===m.initialPassword}},checkType:function(t,s){return{passed:t.val().match({email:/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/gi,creditcard:/^\d{4}\s\d{4}\s\d{4}\s\d{4}$/,cvv:/^\d{3}$/,date:/^\d{2}\s\/\s\d{2}$/}[s])}},passed:function(s){var e=[];return s.find("input").each(function(){var s=t(this),a=[],r=s.next(".rsMultiStep-validation-message");r.length>0?r.html(""):(r=t('<div class="rsMultiStep-validation-message"></div>')).insertAfter(s);var i=s.attr("data-validate");if(i){var n=JSON.parse(i);if(n.required&&!m.checkRequired(s).passed){var p="This value is required";e.push(p),a.push(p)}if(!isNaN(n.min)&&!m.checkMinVal(s,n.min).passed){var u="This value must be at least "+n.min;e.push(u),a.push(u)}if(!isNaN(n.max)&&!m.checkMaxVal(s,n.max).passed){var o="This value must not exceed "+n.max;e.push(o),a.push(o)}if(n.type&&!m.checkType(s,n.type).passed){var l="This value must have a valid "+n.type+" format";e.push(l),a.push(l)}if(n.password&&("initial"===n.password&&(m.initialPassword=s.val()),"match"===n.password&&!m.confirmPassword(s).passed)){var c="Your passwords do not match";e.push(c),a.push(c)}r.html(a.join(". "))}}),e.length<1}},h=t(this).find(".rsMultiStep-step");return h.eq(1).find(".rsMultiStep-btnRow").append('<button class="rsMultiStep-submitBtn">Purchase</button>'),h.each(function(){var s=t(this),a=s.index()+1,r=s.attr("data-step-label");s.parent().prev(".rsMultiStep-progress").append('<span class="rsMultiStep-progressStep rsMultiStep-progressStep'+a+'">\n                              <div class="rsMultiStep-progressStep-num"></div>\n                             </span>'),s.parent().prev(".rsMultiStep-progress").find(".rsMultiStep-progressStep"+a).append(r),s.parent().prev(".rsMultiStep-progress").find(".rsMultiStep-progressStep"+a).find(".rsMultiStep-progressStep-num").html(a);var o=t('<button class="rsMultiStep-nextBtn">Next</button>'),h=t('<button class="rsMultiStep-backBtn">Back</button>'),v=s.find(".rsMultiStep-btnRow"),f=s.parent().prev(".rsMultiStep-progress");s.is(":first-child")&&(s.addClass("rsMultiStep-stepActive"),f.find(".rsMultiStep-progressStep"+a+" .rsMultiStep-progressStep-num").addClass("rsMultiStep-progressStep-numActive"),v.prepend(o)),s.is(":not(:first-child)")&&s.is(":not(:last-child)")&&v.prepend(h),s.find('[name="rs-add-quantity"]').each(function(){t(this).on("keyup",function(){return d.addBoxes(s)})});var S=function(){s.css("height",s.outerHeight()),s.css("width",s.outerWidth()),s.addClass("position-absolute"),s.animate({marginLeft:"-200px",opacity:0},300),s.next().addClass("rsMultiStep-stepActive"),setTimeout(function(){s.removeClass("rsMultiStep-stepActive")},300),f.find(".rsMultiStep-progressStep"+a).next().find(".rsMultiStep-progressStep-num").addClass("rsMultiStep-progressStep-numActive")};s.find(".rsMultiStep-nextBtn, .rsMultiStep-submitBtn").click(function(a){if(!s.is(":animated")){if(a.preventDefault(),e.form&&e.validate&&!m.passed(s))return;if(i.hide(),l<=0)return void i.show().html("You must have at least 1 mail box to proceed.");if(t(a.currentTarget).hasClass("rsMultiStep-submitBtn")){n.show(),p.hide(),t.ajax({type:"POST",url:"https://cors-anywhere.herokuapp.com/https://postman-echo.com/post",headers:{"Content-Type":"application/json"},data:JSON.stringify({form:"data-here"}),success:function(){u.html('\n                  <span class="rsForm-summary-quantity">Rackspace Email x '+c.email+' Mailboxe(s)</span>\n                  <span class="rsForm-summary-quantity">Rackspace Email Plus x '+c.emailPlus+' Mailboxe(s)</span>\n                  <span class="rsForm-summary-quantity">Microsoft Exchange x '+c.exchange+" Mailboxe(s)</span>\n                "),S()},error:function(){i.show().html("There was an error. Please try again!")},complete:function(){n.hide(),p.show()}})}else S()}}),s.find(".rsMultiStep-backBtn").click(function(t){s.prev().is(":animated")||(t.preventDefault(),s.removeClass("rsMultiStep-stepActive"),s.prev().removeClass("position-absolute"),s.prev().addClass("rsMultiStep-stepActive"),s.prev().animate({marginLeft:"0px",opacity:1},300),setTimeout(function(){s.prev().css("height",""),s.prev().css("width","")},300),f.find(".rsMultiStep-progressStep"+a+" .rsMultiStep-progressStep-num").removeClass("rsMultiStep-progressStep-numActive"))})}),this}}(jQuery);